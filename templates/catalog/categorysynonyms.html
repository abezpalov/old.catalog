{% extends "main.html" %}
{% block title %}Anodos: Синонимы категорий{% endblock %}
{% block content %}
{% if perms.catalog.change_product %}

<!-- Форма фильтра вывода -->
<div class="row collapse">
	<fieldset>
		<legend>Фильтр отображения</legend>
		<div class="small-4 columns">
			<label>Загрузчики
				<select id="filter-updater" class="do-filter-table">
					<option value="all"{% if updater_selected == 'all' %} selected{% endif %}> - Все загрузчики - </option>
					{% for updater in updaters %}
					<option value="{{ updater.id }}"{% if updater.id == updater_selected %} selected{% endif %}>{{ updater.name }}</option>
					{% endfor %}
				</select>
			</label>
		</div>
		<div class="small-4 columns">
			<label>Поставщики
				<select id="filter-distributor" class="do-filter-table">
					<option value="all"{% if distributor_selected == 'all' %} selected{% endif %}> - Все поставщики - </option>
					{% for distributor in distributors %}
					<option value="{{ distributor.id }}"{% if distributor.id == distributor_selected %} selected{% endif %}>{{ distributor.name }}</option>
					{% endfor %}
				</select>
			</label>
		</div>
		<div class="small-4 columns">
			<label>Категория
				<select id="filter-category" class="do-filter-table">
					<option value="all"{% if category_selected == 'all' %} selected{% endif %}> - Все категории - </option>
					<option value="null"{% if category_selected == 'null' %} selected{% endif %}> - Не определена - </option>
					{% for category in categories %}
					<option value="{{ category.id }}"{% if category.id == category_selected %} selected{% endif %}>{{ category.name }}</option>
					{% endfor %}
				</select>
			</label>
		</div>
	</fieldset>
</div>

<!-- Таблица со списком синонимов -->
<div class="row collapse">
	<table>
		<tr>
			<th class="text-center">#</th>
			<th>Наименование</th>
			<th class="hide-for-small-only">Загрузчик</th>
			<th class="hide-for-small-only">Поставщик</th>
			<th>Категория</th>
			<th>Управление</th>
		</tr>
		{% for item in items %}
		<tr>
			<td>{{ forloop.counter }}</td>
			<td><a href="/catalog/category-synonym/{{ synonym.id }}/" id="item-{{ item.id }}" data-do="edit-item" data-id="{{ item.id }}" data-category="{{ item.category.id }}">{{ item.name }}</a></td>
			<td class="hide-for-small-only">{{ item.updater }}</td>
			<td class="hide-for-small-only">{{ item.distributor }}</td>
			<td class="hide-for-small-only">{{ item.category.name }}</td>
			<td>
				<button class="tiny alert" data-do="trash-item" data-id="{{ item.id }}"><i class="fa fa-trash"></i></button>
			</td>
		</tr>
		{% endfor %}
	</table>
</div>

<!-- Модальное окно редактирования элемента -->
<div id="EditItemModal" class="reveal-modal large" data-reveal>
	<fieldset>
		<legend>Редактировать синоним категории</legend>
		<input id="edit-item-id" type="hidden">
		<label>Наименование
			<input id="edit-item-name" type="text">
		</label>
		<select id="edit-item-category">
			<option value="null" selected> - Не определена - </option>
			{% for category in categories %}
			<option value="{{ category.id }}">{{ category.name }}</option>
			{% endfor %}
		</select>
	</fieldset>
	<button data-do="edit-item-save">Сохранить</button>
	<button data-do="edit-item-cancel" class="secondary">Отменить</button>
</div>

{% else %}
<div class="row collapse">
	<div class="small-12 columns">
		<p class="panel">Недостаточно прав для данной функциональности.</p>
	</div>
</div>
{% endif %}
{% endblock %}
{% block js-content %}
{% if perms.catalog.change_product %}
<script>
{% include "catalog/js/categorysynonyms.js" %}
</script>
{% endif %}
{% endblock %}
