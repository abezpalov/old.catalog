{% extends "main.html" %}
{% block content %}
<!-- Фильтр вывода -->
<div class="row collapse">
		<ul class="button-group even-3">
			<li><button id="filter-items-category" data-do="open-filter-items-category"{% if category == 'none' %} class="secondary"{% endif %}><i class="fa fa-folder-open-o"></i> Категория</button></li>
			<li><button id="filter-items-vendor" data-do="open-filter-items-vendor"{% if vendor == 'none' %} class="secondary"{% endif %}><i class="fa fa-building"></i> Производитель</button></li>
			<li><button id="filter-items-search" data-do="open-filter-items-search"{% if search == '' %} class="secondary"{% endif %}><i class="fa fa-search"></i> Искомое слово</button></li>
		</ul>
</div>

<!-- Таблица со списком синонимов -->
<div class="row collapse">
	<table>
		<tr>
			<th class="text-center">Артикул</th>
			<th class="text-center">Наименование</th>
			<th class="text-center">Производитель</th>
			<th class="text-center">Цена</th>
			<th class="text-center">Количество</th>
		</tr>
		{% for product in products %}
		{% ifchanged product.category %}
			<td colspan="5"><strong>{% if not product.category %}Без категории{% else %}{{ product.category.name }}</{% endif %}</strong></td>
		{% endifchanged %}
		<tr data-id="{{ product.id }}">
			<td>{{ product.article }}</td>
			<td style="word-break: break-all;"><a href="/catalog/product/{{ product.id }}/">{{ product.name }}</a></td>
			<td class="text-center"><a href="/catalog/vendor/{{ product.vendor.alias }}/">{{ product.vendor.name }}</a></td>
			<td style="white-space: nowrap;" class="text-right">{% autoescape off %}{{ product.price_out }}{% endautoescape %}</td>
			<td style="white-space: nowrap;"></td>
		</tr>
		{% endfor %}
	</table>
</div>

<!-- Модальное окно фильтра -->
<div id="FilterItemsModal" class="reveal-modal large" data-reveal>

	<dl class="tabs" data-tab>
		<dd id="CategoryPanelDD" class="active"><a href="#CategoryPanel"><i class="fa fa-folder-open-o"></i> Категория</a></dd>
		<dd id="VendorPanelDD"><a href="#VendorPanel"><i class="fa fa-building"></i> Производитель</a></dd>
		<dd id="SearchPanelDD"><a href="#SearchPanel"><i class="fa fa-search"></i> Искомое слово</a></dd>
	</dl>
	<div class="tabs-content">
		<div class="content active" id="CategoryPanel">
			<p><span>Категория: </span><span id="filter-items-selected-category" data-id="{{ category }}">не выбрана</span>.</p>
			<ul class="inline-list">
				<li>
					<div class="switch tiny">
						<input id="filter-items-selected-childs" type="checkbox"{% if childs == 'y' %} checked{% endif %}>
						<label for="filter-items-selected-childs"></label>
					</div>
				</li>
				<li>
					<p>Включить дочерние категории.</p>
				</li>
			</ul>
			{% autoescape off %}{{ categories_ul }}{% endautoescape %}
		</div>
		<div class="content" id="VendorPanel">
			<p><span>Производитель: </span><span id="filter-items-selected-vendor" data-alias="{{ vendor }}">не выбран (отображать всех)</span>.</p>
			<ul class="inline-list"><li><a data-do="filter-items-select-vendor" data-alias="all">Все производители</a></li></ul>
			<ul class="inline-list">
				{% for vendor in vendors %}
					<li><a data-do="filter-items-select-vendor" data-alias="{{ vendor.alias }}">{{ vendor.name }}</a></li>
				{% endfor %}
			</ul>
		</div>
		<div class="content" id="SearchPanel">
			<label>Поисковый запрос
				<input id="filter-items-search-input" type="text" placeholder="Артикул, наименование или их часть..." value="{{ search }}">
			</label>
		</div>
	</div>

	<button data-do="filter-items-run">Применить</button>
	<button data-do="filter-items-cancel" class="secondary">Отмена</button>
</div>


{% endblock %}
{% block js-content %}
<script>
{% include "catalog/js/products.js" %}
</script>
{% endblock %}
